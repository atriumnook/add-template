# コーディング規約

## 全般

- 関数・変数名は意図が明確な命名にする（略語は避ける）
- 1ファイルの行数は300行を目安に分割を検討する
- マジックナンバーは定数として定義する
- コメントは「なぜ」を書く。「何をしているか」はコードで表現する

## {{LANGUAGE}} 固有ルール

<!-- プロジェクトの言語に合わせて記載 -->

<!-- 例: TypeScript の場合
- strict モードを有効にする
- any の使用は原則禁止。やむを得ない場合はコメントで理由を記載
- 型定義は interface を優先（type は union/intersection に限定）
- enum は使わない。as const + typeof パターンを使う
- Optional Chaining と Nullish Coalescing を活用する
-->

## ディレクトリ・ファイル構成

<!-- プロジェクトのアーキテクチャに合わせて記載 -->

<!-- 例: クリーンアーキテクチャの場合
src/
├── domain/        # エンティティ・値オブジェクト・リポジトリIF
├── application/   # ユースケース
├── infrastructure/ # 外部サービス・DB実装
└── presentation/  # API・UI

- domain/ は他層に依存しない
- application/ は domain/ にのみ依存
- infrastructure/ は domain/ の interface を実装
- presentation/ は application/ を呼び出す
-->

## エラーハンドリング

- ドメイン固有のエラークラスを定義する
- 例外は握りつぶさない。ログ出力 or 上位への伝播を必ず行う
- ユーザー向けメッセージと開発者向けメッセージを分離する

## テストコード

- テストファイルはテスト対象と同じ名前 + `.test` or `.spec` の接尾辞
- テストファイルの配置は docs/qa/test-strategy.md の方針に従う（tests/ 配下 or ソースと同階層）
- テスト名は日本語で記述し、何をテストしているか明確にする
- Arrange-Act-Assert パターンに従う
- テストデータのハードコードは避け、ファクトリパターンを使う

## インポート順序

<!-- 例:
1. 外部ライブラリ
2. 内部モジュール（絶対パス）
3. 相対パス
各グループ間に空行を入れる
-->

## 環境変数・シークレット管理

- 認証情報・APIキー・シークレットをコードにハードコードしない
- 環境変数で管理し、.env ファイルはリポジトリに含めない（.gitignore に追加）
- .env.example を用意し、必要な環境変数の一覧と説明を記載する
- 環境変数の命名: `{{PREFIX}}_{{CATEGORY}}_{{NAME}}` (例: `APP_DB_HOST`, `APP_SMTP_API_KEY`)

<!-- プロジェクトに応じて記載 -->

## データベースマイグレーション

- マイグレーションファイルは順序が保証される命名にする（タイムスタンプまたは連番）
- 各マイグレーションは1つの変更に限定する
- ロールバック可能なマイグレーションを書く（up / down の両方を定義）
- 本番データの破壊的変更（カラム削除等）は段階的に行う

<!-- プロジェクトの ORM・マイグレーションツールに応じて記載 -->
