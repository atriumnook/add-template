# 既存プロダクトへの導入ガイド

既存プロダクトにこのドキュメント構造を導入する手順。全量移行を目指さず、段階的に進める。

## 前提

- パイロットプロジェクト（新規）で構造とプロセスが安定していること
- 既存ドキュメントが Excel / Confluence 等に散在していること

## Phase 1: 棚卸し（1〜2日）

### 既存ドキュメントの分類

既存の情報を以下の4カテゴリに分類する。全て読む必要はなく、一覧化して分類するだけで良い。

| カテゴリ         | 対応先          | 例                                         |
| ---------------- | --------------- | ------------------------------------------ |
| プロダクト全体像 | docs/project.md | プロダクトビジョン、ターゲットユーザー定義 |
| 現行仕様         | docs/specs/     | API仕様書、画面仕様書、DB設計書            |
| 過去の意思決定   | (移行不要)      | 議事録、過去の要件定義書                   |
| テスト方針       | docs/qa/        | テスト計画書、品質基準                     |

### 重要な判断

**過去の意思決定経緯（requirements 相当）は遡って移行しない。**

理由:

- 過去のフォーマットを新フォーマットに変換するコストが大きい
- 移行しても参照頻度が低い
- 今後の新しい変更から requirements/ に記録を始めれば十分

既存の Confluence / Excel は「参照用アーカイブ」として残し、更新は停止する。

## Phase 2: 骨格の構築（1日）

### リポジトリにディレクトリ構造を追加

```bash
mkdir -p docs/{requirements,specs,adr,qa,guides}
```

### 最低限のファイルを作成

1. **CLAUDE.md**: 既存プロダクトの技術スタック・アーキテクチャを記載
2. **docs/project.md**: プロダクトビジョン・ドメイン用語集を記載
3. **.claude/commands/**: パイロットで使ったコマンドをコピー
4. **.claude/rules/**: パイロットで使ったルールをコピー（プロジェクト固有部分は調整）

## Phase 3: specs のコア部分を移行（1〜2週間）

### 移行対象の選定

全仕様を一度に移行しない。以下の優先順で段階的に移行する。

**優先度 高**: 今後の開発で頻繁に参照する仕様

- 主要ドメインのAPI仕様
- コアとなるドメインモデル
- 現在開発中の機能に関連する仕様

**優先度 中**: 安定しているが参照はされる仕様

- 認証・認可の仕様
- 共通エラーハンドリング
- データベーススキーマ

**優先度 低**: めったに参照されない仕様

- 管理画面の仕様
- バッチ処理の仕様
- レガシー機能の仕様

### 移行の進め方

- 1ドメインずつ移行する
- 移行は通常の開発フローに組み込む（専用のタスクを切って feature ブランチで作業）
- 移行 PR には移行した内容と、既存ドキュメントのどこから移行したかを記録

## Phase 4: 新規変更からフロー運用開始

### 切り替えのルール

**この日以降の新しい変更は全て新フォーマットで管理する。**

- 新機能: requirements/ に要件を作成 → specs/ に仕様策定 → 実装
- 既存機能の変更: requirements/ に MODIFIED セクション付きで経緯を記録 → specs/ を更新
- バグ修正: 軽微なものは直接修正可。仕様の修正を伴う場合は requirements に記録

### Confluence / Excel の扱い

- 新規のドキュメントは作成しない
- 既存ドキュメントの更新も行わない
- 参照用アーカイブとして残す
- チーム内で「新しい情報は Git にある」を周知する
- 移行が完了したドキュメントには「Git に移行済み」と注記を追加

## チェックリスト

- [ ] 既存ドキュメントの棚卸し・分類が完了
- [ ] リポジトリにディレクトリ構造が追加されている
- [ ] CLAUDE.md が既存プロダクトの技術コンテキストを含んでいる
- [ ] docs/project.md が作成されている
- [ ] 優先度の高い specs が移行されている
- [ ] チームに「今後は Git 管理」が周知されている
- [ ] Confluence / Excel の更新停止が合意されている

## よくある抵抗と対処

### 「Confluence の方が見やすい」

→ 書く場所と見る場所は分けて良い。Git で管理し、必要に応じて CI で静的サイト（VitePress 等）に自動デプロイする運用も検討可能。

### 「全部移行するのは大変すぎる」

→ 全量移行は目指さない。今後の変更から Git 管理を始め、既存ドキュメントは必要になった時に移行する。

### 「エンジニア以外がGitを使えない」

→ GitHub の Web UI でマークダウンを編集できる。PR のレビュー機能でディスカッションも可能。ツールの教育コストよりも、情報が散在し続けるコストの方が大きい。
